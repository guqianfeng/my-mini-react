<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <script>
        // const el = document.createElement('div')
        // el.innerHTML = '哈哈'
        // document.body.append(el)
        // let i = 0;
        // while(i < 1e10) {
        //     i++
        // }
        let taskId = 0
        function workLoop(IdleDeadline) {
            taskId++;
            let shouldYield = false // 是否需要让步，初始值不让步，这样能进入while循环做任务
            while (!shouldYield) {
                // run task
                console.log(`taskId: ${taskId}`);
                // 当剩余时间小于1的时候，我就让步不做任务了，跳出循环
                shouldYield = IdleDeadline.timeRemaining() < 1
            }
            requestIdleCallback(workLoop)
        }
        requestIdleCallback(workLoop)
    </script>
</body>

</html>